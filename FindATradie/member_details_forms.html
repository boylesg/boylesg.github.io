<?php
	
	function DoGetDefaultUsername()
	{
		$strUsername = "";
		
		if (isset($_POST["text_username"]))
			$strUsername = $_POST["text_username"];
		else if (isset($_SESSION['account_username'])) 
			$strUsername = $_SESSION['account_username'];
			
		return $strUsername;
	}
	
	function DoGetDefaultPassword()
	{
		$strPassword = "";
		
		if (isset($_POST["text_password"]))
			$strPassword = DoAESDecrypt($_POST["text_password"]);
		else if (isset($_SESSION['account_password'])) 
			$strPassword = $_SESSION['account_password'];

		return $strPassword;
	}
	
	function DoGetDefaultTrade()
	{
		$strTrade = "";
		
		if (isset($_POST["select_trade"]))
			$strTrade = $_POST["select_trade"];
		else if (isset($_SESSION["account_trade"]))
			$strTrade = $_SESSION["account_trade"];
			
		return $strTrade;	
	}

	function DoGetDefaultAdditionalTrades()
	{
		$strTrades = "";
		
		if (isset($_POST["select_additional_trades"]))
			$strTrades = $_POST["select_additional_trades"];
		else if (isset($_SESSION["account_additional_trades"]))
			$strTrades = $_SESSION["account_additional_trades"];
			
		return $strTrades;	
	}
	
	function DoGetDefaultBusinessName()
	{
		$strBusinessName = "";
		
		if (isset($_POST["text_business_name"]))
			$strBusinessName = $_POST["text_business_name"];
		else if (isset($_SESSION["account_business_name"]))
			$strBusinessName = $_SESSION["account_business_name"];

		return $strBusinessName ;
	}
	
	function DoGetDefaultABN()
	{
		$strABN = "";
		
		if (isset($_POST["text_abn"]))
			$strABN = $_POST["text_abn"];
		else if (isset($_SESSION["account_abn"]))
			$strABN = $_SESSION["account_abn"];

		return $strABN;
	}
	
	function DoGetDefaultStructure()
	{
		$strStructure = "";
		
		if (isset($_POST["select_structure"]))
			$strStructure = $_POST["select_structure"];
		else if (isset($_SESSION["account_structure"]))
			$strStructure = $_SESSION["account_structure"];

		return $strStructure;
	}

	function DoGetDefaultLicense()
	{
		$strLicense = "";
		
		if (isset($_POST["text_license"]))
			$strLicense = $_POST["text_license"];
		else if (isset($_SESSION["account_license"]))
			$strLicense = $_SESSION["account_license"];

		return $strLicense;
	}

	function DoGetDefaultDescription()
	{
		$strDescription = "";
		
		if (isset($_POST["description"]))
			$strDescription = $_POST["description"];
		else if (isset($_SESSION["account_description"]))
			$strDescription = $_SESSION["account_description"];

		return $strDescription;
	}

	function DoGetDefaultMinimumCharge()
	{
		$strMinimumCharge = "";
		
		if (isset($_POST["text_minimum_charge"]))
			$strMinimumCharge = sprintf("%.2f", $_POST["text_minimum_charge"]);
		else if (isset($_SESSION["account_minimum_charge"]))
			$strMinimumCharge = sprintf("%.2f", $_SESSION["account_minimum_charge"]);

		return $strMinimumCharge;
	}

	function DoGetDefaultMinimumBudget()
	{
		$strMinimumBudget = "";
		
		if (isset($_POST["text_minimum_budget"]))
			$strMinimumBudget = sprintf("%.2f", $_POST["text_minimum_budget"]);
		else if (isset($_SESSION["account_minimum_budget"]))
			$strMinimumBudget = sprintf("%.2f", $_SESSION["account_minimum_budget"]);

		return $strMinimumBudget;
	}

	function DoGetDefaultMaximumSize()
	{
		$strMaximumSize = "";
		
		if (isset($_POST["select_maximum_size"]))
			$strMaximumSize = $_POST["select_maximum_size"];
		else if (isset($_SESSION["account_maximum_size"]))
			$strMaximumSize = $_SESSION["account_maximum_size"];
			
		return $strMaximumSize;
	}

	function DoGetDefaultMaximumDistance()
	{
		$strMaximumDistance = "";
		
		if (isset($_POST["text_maximum_distance"]))
			$strMaximumDistance = sprintf("%d", $_POST["text_maximum_distance"]);
		else if (isset($_SESSION["account_maximum_distance"]))
			$strMaximumDistance = sprintf("%d", $_SESSION["account_maximum_distance"]);

		return $strMaximumDistance;
	}

	function DoGetDefaultFirstName()
	{
		$strFirstName = "";
		
		if (isset($_POST["text_first_name"]))
			$strFirstName = $_POST["text_first_name"];
		else if (isset($_SESSION["account_first_name"]))
			$strFirstName = $_SESSION["account_first_name"];

		return $strFirstName;
	}

	function DoGetDefaultSurname()
	{
		$strSurname = "";
		
		if (isset($_POST["text_surname"]))
			$strSurname = $_POST["text_surname"];
		else if (isset($_SESSION["account_surname"]))
			$strSurname = $_SESSION["account_surname"];

		return $strSurname;
	}

	function DoGetDefaultUnit()
	{
		$strUnit = "";
		
		if (isset($_POST["text_unit"]))
			$strUnit = $_POST["text_unit"];
		else if (isset($_SESSION["account_unit"]))
			$strUnit = $_SESSION["account_unit"];

		return $strUnit;
	}

	function DoGetDefaultStreet()
	{
		$strStreet = "";
		
		if (isset($_POST["text_street"]))
			$strStreet = $_POST["text_street"];
		else if (isset($_SESSION["account_street"]))
			$strStreet = $_SESSION["account_street"];

		return $strStreet;
	}

	function DoGetDefaultSuburb()
	{
		$strSuburb = "";
		
		if (isset($_POST["text_suburb"]))
			$strSuburb = $_POST["text_suburb"];
		else if (isset($_SESSION["account_suburb"]))
			$strSuburb = $_SESSION["account_suburb"];

		return $strSuburb;
	}

	function DoGetDefaultState()
	{
		$strState = "";
		
		if (isset($_POST["select_state"]))
			$strState = $_POST["select_state"];
		else if (isset($_SESSION["account_state"]))
			$strState = $_SESSION["account_state"];

		return $strState;
	}

	function DoGetDefaultPostcode()
	{
		$strPostcode = "";
		
		if (isset($_POST["text_postcode"]))
			$strPostcode = $_POST["text_postcode"];
		else if (isset($_SESSION["account_postcode"]))
			$strPostcode = $_SESSION["account_postcode"];

		return $strPostcode;
	}

	function DoGetDefaultPhone()
	{
		$strPhone = "";
		
		if (isset($_POST["text_phone"]))
			$strPhone = $_POST["text_phone"];
		else if (isset($_SESSION["account_phone"]))
			$strPhone = $_SESSION["account_phone"];

		return $strPhone;
	}

	function DoGetDefaultMobile()
	{
		$strMobile = "";
		
		if (isset($_POST["text_mobile"]))
			$strMobile = $_POST["text_mobile"];
		else if (isset($_SESSION["account_mobile"]))
			$strMobile = $_SESSION["account_mobile"];

		return $strMobile;
	}

	function DoGetDefaultEmail()
	{
		$strEmail = "";
		
		if (isset($_POST["text_email"]))
			$strEmail = $_POST["text_email"];
		else if (isset($_SESSION["account_email"]))
			$strEmail = $_SESSION["account_email"];

		return $strEmail;
	}

?>

<form method="post" id="form_user_details" action="" class="form" style="width: 1100px;">
	<fieldset>
		<legend>User details:</legend>
		<table class="table_no_borders">
			<tr>
				<td class="cell_no_borders" style="text-align:right;vertical-align:top;width:170px;"><b>Username or email</b></td>
				<td class="cell_no_borders" style="">
					<input type="text" id="text_username" name="text_username" required minlength="8" value="<?php echo DoGetDefaultUsername(); ?>" />
					<br/><br/>
					Letters, digits, @ $ ! % * # ? &amp;, 8 chracters minimum.
					
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;vertical-align:top;"><b>Password</b></td>
				<td class="cell_no_borders">
					<input type="text" id="text_password" name="text_password" required pattern="(?=[a-zA-Z0-9#@$?\-\.]{8,}$)(?=.*?[a-z])(?=.*?[A-Z])(?=.*?[0-9]).*" value="<?php echo DoGetDefaultPassword(); ?>" />
					<br/><br/>
					At least 1 uppercase letter, 1 lower case letter, 1 digit, optional @ $ ! % * ? # &amp; -, 8 chracters minimum.					
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;vertical-align:top;"><b>Password again</b></td>
				<td class="cell_no_borders">
					<input type="text" id="text_password_again" required pattern="(?=[a-zA-Z0-9#@$?\-\.]{8,}$)(?=.*?[a-z])(?=.*?[A-Z])(?=.*?[0-9]).*" value="<?php echo DoGetDefaultPassword(); ?>" />
					<br/><br/>
					At least 1 uppercase letter, 1 lower case letter, 1 digit, optional @ $ ! % * ? # &amp; -, 8 chracters minimum.
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" colspan="2">&nbsp;</td>
			</tr>
			<tr>
				<td class="cell_no_borders" colspan="2"><input type="button" name="button_user_details" id="button_user_details" onclick="DoUserDetailsFormSubmit('form_user_details')" /></td>

			</tr>
		</table>		
	</fieldset>
</form>
<br/><br/>
<form method="post" id="form_trade_details" action="" class="form" style="width:950px;">
	<fieldset>
		<legend>Trade details</legend>
			<table class="table_no_borders">
				<tr>
					<td class="cell_no_borders" style="text-align:right;vertical-align:top;"><b>Primary trade</b></td>
					<td class="cell_no_borders">
						<select id="select_trade" name="select_trade" onchange="OnChangeTrade(this, DoGetInput('trade_description'))">
							<?php DoGeneratePrimaryTradeOptions(DoGetDefaultTrade()); ?>
						</select>
						<br/><br/>
						<label id="trade_description">XXXXXXXXXXXXX</label>
					</td>
				</tr>
				<tr>
					<td class="cell_no_borders" style="text-align:right;vertical-align:top;"><b>Additional trades</b></td>
					<td class="cell_no_borders">
						<select id="select_additional_trades" name="select_additional_trades[]" multiple="multiple" size="10">
							<?php DoGenerateAdditionalTradeOptions(DoGetDefaultAdditionalTrades()); ?>
						</select><br/>
						<b><i>Hold down the CTRL key and click the left mouse button to select multiple items...</i></b>
					</td>
				</tr>
				<tr>
					<td class="cell_no_borders" colspan="2">
					<?php
						echo "<a style=\"color:MidnightBlue;\" href=\"mailto:gregplants@bigpond.com?subject=Request a new trade&body=Trade name: %0D%0A%0D%0A%0D%0ADescription%0D%0A----------------%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A\">Request addition of a new trade.</a>";
					?>
					</td>
				</tr>
				<tr>
					<td class="cell_no_borders" colspan="3">&nbsp;</td>
				</tr>
				<tr>
					<td class="cell_no_borders" colspan="3"><input type="button" name="button_trade_details" id="button_trade_details" onclick="DoFormSubmit('form_trade_details')" /></td>
				</tr>
			</table>
	</fieldset>
</form>
<br/><br/>		
<form method="post" id="form_business_details" action="" class="form" style="width:1250px;">
	<fieldset>
		<legend>Business details:</legend>
		<table class="table_no_borders">
			<tr>
				<td class="cell_no_borders" style="text-align:right;width:338px;"><b>Business name</b></td>
				<td class="cell_no_borders">
					<input type="text" id="text_business_name" name="text_business_name" size="32" required pattern="^(?=[^A-Za-z]*[A-Za-z])[ -~]*$" value="<?php echo DoGetDefaultBusinessName(); ?>" />
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;width:338px;"><b>Business logo</b></td>
				<td class="cell_no_borders">
					<input type="text" id="text_business_name" name="text_business_name" size="32" required pattern="^(?=[^A-Za-z]*[A-Za-z])[ -~]*$" value="<?php echo DoGetDefaultBusinessName(); ?>" />
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;"><b>ABN</b></td>
				<td class="cell_no_borders"><input type="text" id="text_abn" name="text_abn" size="32" required pattern="^(\d *?){11}$" value="<?php echo DoGetDefaultABN() ?>" onkeydown="OnKeyPressDigitsSpaceOnly(event)" /> e.g. 51 824 753 556</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;"><b>Business structure</b></td>
				<td class="cell_no_borders">
					<select id="select_structure" name="select_structure" required>
						<?php include "business_structure.html"; ?>
					</select>
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;"><b>Trade license numbers etc.</b></td>
				<td class="cell_no_borders">
					<textarea id="text_license" name="text_license" cols="64" rows="4"><?php echo DoGetDefaultLicense(); ?></textarea>
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;vertical-align:top;"><b>Business description &amp; philosophy etc.</b></td>
				<td class="cell_no_borders">
					<textarea id="text_description" name="text_description" cols="64" rows="16" required><?php echo DoGetDefaultDescription(); ?></textarea>
					<br/><br/>
					Enter a more detailed description of your business: services, specialties, offers and philosophy etc.
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;vertical-align:top;"><b>Minimum charge</b></td>
				<td class="cell_no_borders">
					<b>$</b>&nbsp;<input type="text" id="text_minimum_charge" size="8" name="text_minimum charge" required value="<?php echo DoGetDefaultMinimumCharge(); ?>" onkeydown="OnKeyPressDigitsOnly(event)" />
					<br/><br/>
					Be fairdinkum here - you are no more or less likely to get the job if you don't disclose this up front.
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;vertical-align:top;"><b>Minimum budget</b></td>
				<td class="cell_no_borders">
					<b>$</b>&nbsp;<input type="text" id="text_minimum_budget" size="8" name="text_minimum_budget" required value="<?php echo DoGetDefaultMinimumBudget(); ?>" onkeydown="OnKeyPressDigitsOnly(event)" />
					<br/><br/>
					This is for tradies who are not interested in small value jobs. Enter 0 if you will accept jobs of any value.
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;"><b>Maximum size</b></td>
				<td class="cell_no_borders">
					<select id="select_maximum_size" name="select_maximum_size" required>
						<?php include "job_size.html"; ?>
					</select>&nbsp;<b>m<sup>2</sup></b>
					<script type="text/javascript"> SetSelectionValue("select_maximum_size", "<?php echo DoGetDefaultMaximumSize(); ?>"); </script>
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;vertical-align:top;"><b>Maximum distance</b></td>
				<td class="cell_no_borders">
					<input type="text" id="text_maximum_distance" name="text_maximum distance" size="8" required value="<?php echo DoGetDefaultMaximumDistance() ?>" style="text-align:right" onkeydown="OnKeyPressDigitsOnly(event)" />&nbsp;<b>km</b>
					<br/><br/>
					Enter 0 if you will travel any distance.
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" colspan="2">&nbsp;</td>
			</tr>
			<tr>
				<td class="cell_no_borders" colspan="2"><input type="button" name="button_business_details" id="button_business_details" onclick="DoFormSubmit('form_business_details')" /></td>
			</tr>
		</table>			
	</fieldset>
</form>
<br/><br/>
<form method="post" id="form_contact_details" action="" class="form" style="width:650px;">
	<fieldset>
		<legend>Contact details:</legend>
		<table class="table_no_borders">
			<tr>
				<td class="cell_no_borders" style="text-align:right;"><b>First name</b></td>
				<td class="cell_no_borders">
					<input type="text" id="text_first_name" name="text_first_name" size="32" required pattern="^[A-Za-z ,.'\-]+$" value="<?php echo DoGetDefaultFirstName(); ?>" />
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;"><b>Surname</b></td>
				<td class="cell_no_borders">
					<input type="text" id="text_surname" name="text_surname" size="32" required pattern="^[A-Za-z ,.'\-]+$" value="<?php echo DoGetDefaultSurname(); ?>" />
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;"><b>Unit</b></td>
				<td class="cell_no_borders">
					<input type="text" id="text_unit" name="text_unit" size="32" value="<?php echo DoGetDefaultUnit(); ?>" />
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;"><b>Street</b></td>
				<td class="cell_no_borders">
					<input type="text" id="text_street" name="text_street" size="32" pattern="^(\b\D+\b)?\s*(\b.*?\d.*?\b)\s*(\b\D+\b)?$" value="<?php echo DoGetDefaultStreet(); ?>" />
					<br/>You are not required to enter a street address.
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;"><b>City/suburb/town</b></td>
				<td class="cell_no_borders">
					<input type="text" id="text_suburb" name="text_suburb" size="32" required pattern="^([a-zA-Z\u0080-\u024F]+(?:. |-| |'))*[a-zA-Z\u0080-\u024F]*$" value="<?php echo DoGetDefaultSuburb(); ?>" />
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;"><b>State</b></td>
				<td class="cell_no_borders">
					<select id="select_state" name="select_state">
						<?php include "states.html"; ?>
					</select>
					<script type="text/javascript"> SetSelectionValue("select_state", "<?php echo DogetDefaultState(); ?>"); </script>
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;"><b>Postcode</b></td>
				<td class="cell_no_borders">
					<input type="text" id="text_postcode" name="text_postcode" size="6" length="4" maxlength="4" required pattern="^[0-9]{4}$" value="<?php echo DoGetDefaultPostcode(); ?>" />
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;"><b>Phone</b></td>
				<td class="cell_no_borders">
					<input type="text"  id="text_phone" name="text_phone" maxlength="8" required pattern="^[0-9]{8}$" value="<?php echo DoGetDefaultPhone(); ?>" onkeydown="OnKeyPressDigitsOnly(event)" />
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;"><b>Mobile</b></td>
				<td class="cell_no_borders">
					<input type="text"  id="text_mobile" name="text_mobile" maxlength="10" required pattern="^[0-9]{10}$" value="<?php echo DoGetDefaultMobile(); ?>" onkeydown="OnKeyPressDigitsOnly(event)" />
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" style="text-align:right;"><b>Email</b></td>
				<td class="cell_no_borders">
					<input type="text"  id="text_email" name="text_email" required pattern="^^[A-Za-z]{1,}[A-Za-z0-9\.\-_]{1,}@[A-Za-z0-9\-_]{1,}\.[A-Za-z]{3,}(\.*[A-Za-z]{2}){0,1}$" value="<?php echo DoGetDefaultEmail(); ?>" />
				</td>
			</tr>
			<tr>
				<td class="cell_no_borders" colspan="2">&nbsp;</td>
			</tr>
			<tr>
				<td class="cell_no_borders"><input type="button" name="button_contact_details" id="button_contact_details" onclick="DoFormSubmit('form_contact_details')" /></td>
				<td class="cell_no_borders">
					<input type="button" name="button_save" id="button_save" value="SAVE" style="display:none;" onclick="DoFormSubmitAll()" />
				</td>
			</tr>
		</table>			
	</fieldset>
</form>

<form method="post" id="form_all_details" action="" class="form" style="display:none;">
	<input type="text" id="htext_username" name="text_username" />
	<input type="password" id="htext_password" name="text_password" />
	<select id="hselect_trade" name="select_trade">
		<?php DoGeneratePrimaryTradeOptions(""); ?>
	</select>
	<select id="hselect_additional_trades" name="select_additional_trades[]" multiple="multiple">
		<?php DoGenerateAdditionalTradeOptions($_SESSION["account_additional_trades"]); ?>
	</select>
	<input type="text" id="htext_business_name" name="text_business_name" />
	<input type="text" id="htext_abn" name="text_abn" />
	<select id="hselect_structure" name="select_structure">
		<?php include "business_structure.html"; ?>
	</select>
	<textarea id="htext_license" name="text_license"></textarea>
	<textarea id="htext_description" name="text_description"></textarea>
	<input type="htext" id="htext_minimum_charge" name="text_minimum charge" />
	<input type="htext" id="htext_minimum_budget" name="text_minimum_budget" />
	<select id="hselect_maximum_size" name="select_maximum_size" required>
		<?php include "job_size.html"; ?>
	</select>
	<input type="text" id="htext_maximum_distance" name="text_maximum distance" />
	<input type="text" id="htext_first_name" name="text_first_name" />
	<input type="text" id="htext_surname" name="text_surname" />
	<input type="text" id="htext_unit" name="text_unit" />
	<input type="text" id="htext_street" name="text_street" />
	<input type="text" id="htext_suburb" name="text_suburb" />
	<select id="hselect_state" name="select_state">
		<?php include "states.html"; ?>
	</select>
	<input type="text" id="htext_postcode" name="text_postcode" />
	<input type="text"  id="htext_phone" name="text_phone" />
	<input type="text"  id="htext_mobile" name="text_mobile" />
	<input type="text"  id="htext_email" name="text_email" />
	<input type="hidden" id="submit_all_details" name="submit_all_details" value="SUBMIT" />
</form>

<form method="post" id="form_login" style="display:none;" action="login.php">
	<input type="text" id="text_username" name="text_username" value="<?php if (isset($_POST["text_username"])) echo $_POST["text_username"]; ?>"/>
	<input type="text" id="text_password" name="text_password" value="<?php if (isset($_POST["text_password"])) echo $_POST["text_password"]; ?>"/>
	<input type="submit" name="submit_login" value="LOG IN" />
</form>

<script type="text/javascript">
	
	let g_bIsCustomer = false;
	let g_bIsStaged = true;
	
	//******************************************************************************
	//******************************************************************************
	//** 
	//** FUNCTIONS FOR THE ABOVE FORMS
	//** 
	//******************************************************************************
	//******************************************************************************
	
	const g_mapFormInputs = new Map([
								["form_trade_details", ["select_trade" , "select_additional_trades"]],
								["form_business_details", ["text_business_name", "text_abn", "select_structure", "text_license", 
									"text_description", "text_minimum_charge", "text_minimum_budget", "select_maximum_size", 
									"text_maximum_distance"]],
								["form_contact_details", ["text_first_name", "text_surname",  "text_unit",  "text_street",  
									"text_suburb",  "select_state",  "text_postcode",  "text_phone",  "text_mobile",  
									"text_email"]],
								["form_user_details", [ "text_username", "text_password",  "text_password_again"]]
									]);

	OnChangeTrade(document.getElementById('select_trade'), document.getElementById('trade_description'));

	function IsValid(Input)
	{
		let bResult = true,
			bWasPassword = false;
		
		if (Input.type === "password")
		{	
			bWasPassword = true;
			Input.type = "text";
		}
		if (Input.type === "text")
		{
			if (!Input.checkValidity())
			{
				Input.reportValidity();
				Input.focus();
				bResult = false;
			}
		}
		if (bWasPassword)
		{
			Input.type = "password";
		}
		return bResult;
	}
	
	function DoChangeButtonFunction(strButtonID, NewFunction)
	{
		let button = DoGetInput(strButtonID, "button");
		if (button)
		{
			button.onclick  = NewFunction;
		}
	}
	
	function DoFormValidate(strFormID)
	{
		let arrayInputIDs = null,
			input = null,
			bResult = true,
			form = DoGetInput(strFormID, 'form');
		
		if (form)
		{
			arrayInputIDs = g_mapFormInputs.get(form.id);
			
			for (let nI = 0; nI < arrayInputIDs.length; nI++) 
			{
				input = DoGetInput(arrayInputIDs[nI], 'input');
				if (input)
				{
	    	        if (!IsValid(input))
	        		{
	        			bResult = false;
	        			break;
	        		}
	        	}
	        	else
	        	{
					AlertIDError(arrayInputIDs[nI], "input");
	        		bResult = false;
	        		break;
	        	}
			}	
		}
		else
		{
			AlertIDError(strFormID , "form");
		}
		return bResult;
	}
	
	function DoCopyTextInput(strIDSrc, strIDDest)
	{
		let inputTextSrc = DoGetInput(strIDSrc),
			inputTextDest = DoGetInput(strIDDest);
			
		if (inputTextSrc && inputTextDest)
		{
			inputTextDest.value = inputTextSrc.value;
		}
	}
	
	function DoCopySelectInput(strIDSrc, strIDDest)
	{
		let inputSelectSrc = DoGetInput(strIDSrc),
			inputSelectDest = DoGetInput(strIDDest);
			
		if (inputSelectSrc && inputSelectDest)
		{
			inputSelectDest.selectedIndex = inputSelectSrc.selectedIndex;
		}
	}
	
	function DoNextStage(strFormID)
	{
		if (strFormID == "form_user_details")
		{
			DoGetInput("form_user_details").style.display = "none";
			if (g_bIsCustomer)
			{
				DoGetInput("form_contact_details").style.display = "block"
			}
			else
			{
				DoGetInput("form_trade_details").style.display = "block";
			}
		}
		else if (strFormID == "form_trade_details")
		{
			DoGetInput("form_trade_details").style.display = "none";
			DoGetInput("form_business_details").style.display = "block";
		}
		else if (strFormID == "form_business_details")
		{
			DoGetInput("form_business_details").style.display = "none";
			DoGetInput("form_contact_details").style.display = "block";
		}
		else if (strFormID == "form_contact_details")
		{
			DoGetInput("form_contact_details").style.display = "none";
			DoGetInput("form_user_details").style.display = "block";
		}
	}
	
	function DoFormSubmit(strFormID)
	{
		if (DoFormValidate(strFormID))
		{
			if (g_bIsStaged)
			{
				DoNextStage(strFormID);
			}
			else
			{
				document.getElementById(strFormID).submit();
			}
		}
	}
	
	function DoUserDetailsFormSubmit(strFormID)
	{
		if (DoFormValidate(strFormID))
		{
			let textPassword = DoGetInput("text_password"),
				textPasswordAgain = DoGetInput("text_password_again");
			
			if (!textPassword)
			{
				AlertIDError("text_password", "password input");
			}
			else if (!textPasswordAgain)
			{
				AlertIDError("text_password_again", "password input");
			}
			else if (textPassword.value != textPasswordAgain.value)
			{
				AlertError("The two passwords do not match!");
				textPassword.focus();
			}
			else
			{
				DoFormSubmit(strFormID);
			}
		}
	}
	
	function DoChangeFormButtonText(strText)
	{
		DoGetInput("button_trade_details").value = strText; 
		DoGetInput("button_business_details").value = strText;
		DoGetInput("button_contact_details").value = strText;
		DoGetInput("button_user_details").value = strText;
	}
	
	function DoSetStaged()
	{
		DoGetInput("form_trade_details").style.display = "none";
		DoGetInput("form_business_details").style.display = "none";
		DoGetInput("form_contact_details").style.display = "none";
		DoGetInput("form_contact_details").style.display = "none";
		DoGetInput("button_save").style.display = "inline";
		DoChangeFormButtonText('NEXT');
		g_bIsStaged = true;
	}
	
	function DoSetNotStaged()
	{
		DoGetInput("form_trade_details").style.display = "block";
		DoGetInput("form_business_details").style.display = "block";
		DoGetInput("form_contact_details").style.display = "block";
		DoGetInput("form_contact_details").style.display = "block";
		DoGetInput("button_save").style.display = "none";
		DoChangeFormButtonText('SAVE');
		g_bIsStaged = false;

	}
	
	function DoSetCustomer()
	{
		DoGetInput("submit_all_details").value = "SUBMIT_NEW_CUSTOMER";
		g_bIsCustomer = true;
	}
	
	function DoSetTradie()
	{
		DoGetInput("submit_all_details").value = "SUBMIT_NEW_TRADIE";
		g_bIsCustomer = false;
	}
	
	function DoFormSubmitAll()
	{
		DoGetInput("htext_username").value = DoGetInput("text_username").value;
		if (!g_bIsCustomer)
		{
			DoCopySelectInput("select_trade", "hselect_trade");
			DoCopySelectInput("select_additional_trades", "hselect_additional_trades");
			DoCopyTextInput("text_business_name", "htext_business_name");
			DoCopyTextInput("text_abn", "htext_abn");
			DoCopyTextInput("text_license", "htext_license");
			DoCopyTextInput("text_description", "htext_description");
			DoCopyTextInput("text_minimum_charge", "htext_minimum_charge");
			DoCopyTextInput("text_minimum_budget", "htext_minimum_budget");
			DoCopyTextInput("text_maximum_distance", "htext_maximum_distance");
			DoCopySelectInput("select_structure", "hselect_structure");
			DoCopySelectInput("select_maximum_size", "hselect_maximum_size");
		}
		DoCopyTextInput("text_first_name", "htext_first_name");
		DoCopyTextInput("text_surname", "htext_surname");
		DoCopyTextInput("text_unit", "htext_unit");
		DoCopyTextInput("text_street", "htext_street");
		DoCopyTextInput("text_suburb", "htext_suburb");
		DoCopyTextInput("text_postcode", "htext_postcode");
		DoCopyTextInput("text_phone", "htext_phone");
		DoCopyTextInput("text_mobile", "htext_mobile");
		DoCopyTextInput("text_email", "htext_email");
		DoCopySelectInput("select_state", "hselect_state");
		DoGetInput("form_all_details").submit();
	}
	
	OnChangeTrade(document.getElementById('select_trade'), document.getElementById('trade_description_search'));
	OnChangeTrade(document.getElementById('select_trade'), document.getElementById('trade_description_job'));
			
	SetSelection("select_structure", "<?php if (isset($_SESSION["account_structure"])) echo $_SESSION["account_structure"]; else echo ""; ?>");
	SetSelection("select_maximum_size", "<?php if (isset($_SESSION["account_maximum_size"])) echo $_SESSION["account_maximum_size"]; else echo ""; ?>");
	SetSelection("select_state", "<?php if (isset($_SESSION["account_state"])) echo $_SESSION["account_state"]; else echo ""; ?>");
	
</script>

	
